(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{81:function(e,t,a){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,t,a,r){void 0===r&&(r=a),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,r){void 0===r&&(r=a),e[r]=t[a]}),n=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),l=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)"default"!==a&&Object.hasOwnProperty.call(e,a)&&r(t,e,a);return n(t,e),t},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0;var i=l(a(2)),u=a(83),s=a(87),o=a(102),m=a(35),f=a(37),d=a(101),p=c(a(93)),h=a(94),g=a(95),v=a(96);function E(){var e=i.useRef(null),t=i.useState(),a=t[0],r=t[1];i.useEffect((function(){var t=g.fromScrollEvents(e).subscribe((function(e){return r(e)}));return function(){return t.unsubscribe()}}),[e]);var n=i.useState(""),l=n[0],c=n[1],u=d.useObservable((function(e){return e.pipe(d.pluckFirst,f.filter((function(e){return e.length>=3})),f.debounceTime(300),v.tapLog("searchTerm"))}),[l]),s=d.useObservable((function(e){return e.pipe(d.pluckFirst,f.flatMap((function(e){return e?m.of(e):m.EMPTY})),f.filter((function(e){var t=e.scrollTop,a=e.scrollTopMax;return t>=Math.max(0,a-500)})))}),[a]);var o=d.useObservable((function(e){return e.pipe(d.pluckFirst,f.flatMap(m.identity)).pipe(f.switchMap((function(e){var t=new m.BehaviorSubject(0),a=s.pipe(f.startWith());return m.zip(t,a).pipe(d.pluckFirst,v.tapLog("offset"),f.flatMap((function(t){return h.searchPlayer(e,t,100)})),f.tap((function(e){return 0===e.items.length?t.complete():t.next(e.end)})),v.tapLog("resultPages")).pipe(f.map((function(e){return e.items})),f.scan((function(e,t){return e.concat(t)}),[]),f.map(y))})))}),[u]),p=i.useState([]),E=p[0],b=p[1];return d.useSubscription(o,b),i.default.createElement("div",{className:"search-form"},i.default.createElement("input",{type:"text",onChange:function(e){c(e.currentTarget.value)}}),i.default.createElement("ul",{className:"search-results",ref:e},E.map((function(e){return i.default.createElement(x,{result:e,key:e.player_id})}))))}function y(e){var t=new Set,a=[];return e.forEach((function(e){t.has(e.player_id)||(t.add(e.player_id),a.push(e))})),a}function x(e){var t=e.result;return i.default.createElement("li",{className:"search-result"},i.default.createElement(o.Link,{to:"/player/"+t.player_id},i.default.createElement("img",{className:"avatar",src:""===t.avatar?p.default:t.avatar}),i.default.createElement("span",{className:"nickname"},t.nickname)))}function b(){var e,t,a=o.useParams().playerId,r=d.useObservable((function(e){return e.pipe(d.pluckFirst,f.switchMap((function(e){return h.getPlayer(e)})))}),[a]),n=i.useState(!1),l=n[0],c=n[1],u=d.useObservableState(r);return u&&u.player_id===a?i.default.createElement(i.default.Fragment,null,i.default.createElement("div",{className:"player"},i.default.createElement("img",{className:"player-avatar",src:""===u.avatar?p.default:u.avatar}),i.default.createElement("div",{className:"player-info"},i.default.createElement("h2",null,u.nickname," (",u.country,")"),i.default.createElement("ul",null,i.default.createElement("li",null,i.default.createElement("a",{href:"https://www.faceit.com/en/players/"+u.nickname},"FACEIT profile")),u.steam_id_64&&i.default.createElement("li",null,i.default.createElement("a",{href:"https://steamcommunity.com/profiles/"+u.steam_id_64},"Steam profile")),(null===(t=null===(e=u.games)||void 0===e?void 0:e.csgo)||void 0===t?void 0:t.faceit_elo)&&i.default.createElement("li",null,"CS:GO elo ",u.games.csgo.faceit_elo)))),i.default.createElement("div",null,i.default.createElement("button",{onClick:function(){return c(!l)}},"Show JSON"),l&&i.default.createElement(v.DebugValue,{name:"player",value:u})),i.default.createElement(w,{playerId:u.player_id})):i.default.createElement("p",null,"Loading...")}function w(e){var t=e.playerId,a=d.useObservable((function(e){return e.pipe(d.pluckFirst,f.switchMap((function(e){return h.getMatchHistory(e,"csgo")})),f.map((function(e){return e.items})))}),[t]),r=d.useObservableState(a,[]);return i.default.createElement("div",{className:"match-history"},i.default.createElement("h2",null,"Match history"),r.map((function(e){return i.default.createElement(_,{key:e.match_id,playerId:t,matchId:e.match_id})})))}function _(e){var t=e.playerId,a=e.matchId,r=d.useObservable((function(e){return e.pipe(d.pluckFirst,f.switchMap((function(e){return h.getMatch(e)})))}),[a]),n=d.useObservableState(r);return n&&a===n.match_id?i.default.createElement("div",{className:"match"},2===n.version&&i.default.createElement(M,{match:n,playerId:t}),1===n.version&&i.default.createElement(S,{match:n,playerId:t})):i.default.createElement("p",null,"Loading...")}function S(e){e.match,e.playerId;return i.default.createElement("p",null,"TODO")}function M(e){var t,a=e.match,r=e.playerId,n=function(e,t){return e.roster.find((function(e){return e.player_id===t}))},l=function(e){var t=e.team;return i.default.createElement("span",{className:n(t,r)?"home-team":"enemy-team"},t.name)},c=i.useState(!1),u=c[0],o=c[1],m=a.teams[a.results.winner],f=n(m,r)?i.default.createElement("span",{className:"win"},"WIN"):i.default.createElement("span",{className:"loss"},"LOSS");return i.default.createElement("div",null,i.default.createElement("div",{className:"match-header",onClick:function(){return o(!u)}},i.default.createElement("div",{className:"result"},i.default.createElement("p",null,f)),i.default.createElement("div",{className:"match-name"},i.default.createElement("p",null,i.default.createElement(l,{team:a.teams.faction1})," vs ",i.default.createElement(l,{team:a.teams.faction2}))),i.default.createElement("div",{className:"timestamp"},i.default.createElement("p",null,(t=a.started_at,s.DateTime.fromSeconds(t).toRelative()))),i.default.createElement("div",{className:"toggle"},i.default.createElement("p",null,u?i.default.createElement("i",{className:"fas fa-chevron-down"}):i.default.createElement("i",{className:"fas fa-chevron-right"})))),u&&i.default.createElement(N,{match:a}))}function N(e){var t=e.match,a=function(e){return i.default.createElement("div",{className:"team"},i.default.createElement("img",{className:"avatar",src:""===e.avatar?p.default:e.avatar}),i.default.createElement("div",{className:"players"},i.default.createElement("h2",null,e.name),i.default.createElement("ul",null,e.roster.map((function(e){return i.default.createElement("li",{key:e.player_id},e.nickname)})))))},r=i.useState(!1),n=r[0],l=r[1];return i.default.createElement("div",{className:"match-details"},i.default.createElement("div",{className:"teams"},a(t.teams.faction1),a(t.teams.faction2)),i.default.createElement("button",{onClick:function(){return l(!n)}},"Show JSON"),n&&i.default.createElement(v.DebugValue,{name:"match",value:t}))}a(97),u.render(i.default.createElement((function(){return i.default.createElement(o.HashRouter,null,i.default.createElement(E,null),i.default.createElement("div",{className:"main-content"},i.default.createElement(o.Route,{path:"/player/:playerId"},i.default.createElement(b,null))))}),null),document.getElementById("app"))},93:function(e,t,a){"use strict";a.r(t),t.default=a.p+"7a2dcae25524daba0f2f1485ce5c07e3.jpg"},94:function(e,t,a){"use strict";t.__esModule=!0,t.getMatchStats=t.getMatch=t.getMatchHistory=t.getPlayer=t.searchPlayer=void 0;var r=a(35),n=a(37);function l(e,t,a){var n=a?"https://open.faceit.com/data/v4"+t+"?"+function(e){var t=new URLSearchParams;return Object.entries(e).forEach((function(e){var a=e[0],r=e[1];return t.append(a,r)})),t.toString()}(a):"https://open.faceit.com/data/v4"+t;return new r.Observable((function(a){var r=new AbortController,l=!1;return fetch(n,{method:e,headers:{Authorization:"Bearer 82592226-3fb7-41cf-941c-7098de7d84c7"},signal:r.signal}).then((function(e){l=!0,a.next(e),a.complete()})).catch((function(e){a.error(e),a.complete()})),function(){l||(console.log("Cancelling request in progress: "+t),r.abort())}}))}t.searchPlayer=function(e,t,a){return l("GET","/search/players",{nickname:e,game:"csgo",offset:String(t),limit:String(a)}).pipe(n.flatMap((function(e){return r.from(e.json())})))},t.getPlayer=function(e){return l("GET","/players/"+e).pipe(n.flatMap((function(e){return r.from(e.json())})))},t.getMatchHistory=function(e,t){return l("GET","/players/"+e+"/history",{game:t}).pipe(n.flatMap((function(e){return r.from(e.json())})))},t.getMatch=function(e){return l("GET","/matches/"+e).pipe(n.flatMap((function(e){return r.from(e.json())})))},t.getMatchStats=function(e){return l("GET","/matches/"+e+"/stats").pipe(n.flatMap((function(e){return r.from(e.json())})))}},95:function(e,t,a){"use strict";t.__esModule=!0,t.fromScrollEvents=void 0;var r=a(35),n=a(37);function l(e,t){return JSON.stringify(e)===JSON.stringify(t)}t.fromScrollEvents=function(e){return r.merge((t=e.current,r.merge(r.fromEvent(t,"scroll"),r.fromEvent(window,"resize")).pipe(n.throttleTime(200),n.map((function(){return t})))),r.interval(1e3)).pipe(n.map((function(){return t=e.current,"undefined"==typeof window?{scrollTop:0,scrollTopMax:0}:{scrollTop:t.scrollTop,scrollTopMax:t.scrollHeight-t.clientHeight};var t})),n.distinctUntilChanged(l));var t}},96:function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};t.__esModule=!0,t.DebugValue=t.tapLog=void 0;var n=a(37),l=r(a(2));t.tapLog=function(e){return n.tap((function(t){return console.log(e+"$ ->",t)}))},t.DebugValue=function(e){var t=e.name,a=e.value;return l.default.createElement("pre",null,t," === ",JSON.stringify(a,null,2))}},97:function(e,t,a){var r=a(98),n=a(99);"string"==typeof(n=n.__esModule?n.default:n)&&(n=[[e.i,n,""]]);var l={insert:"head",singleton:!1};r(n,l);e.exports=n.locals||{}},99:function(e,t,a){(t=a(100)(!1)).push([e.i,"@import url(https://fonts.googleapis.com/css?family=Source+Sans+Pro);"]),t.push([e.i,"body{font-family:'Source Sans Pro', sans-serif;color:#333;background-color:#f7f7f7}.search-form{position:fixed;top:0;left:0;overflow:none;height:100%;width:300px;display:flex;flex-direction:column}.search-form input{min-height:12px;height:12px;padding:10px}.search-form .search-results{flex-grow:1;overflow-y:scroll}.search-form .search-results .search-result a{display:flex;height:32px}.search-form .search-results .search-result a .nickname{flex-grow:1;vertical-align:middle;line-height:32px}.search-form .search-results .search-result{border-bottom:1px dashed #ddd;box-sizing:border-box}.search-form .search-results .search-result .avatar{width:32px;height:32px;margin-right:10px}.search-form ul{margin:0;padding:0}.search-form li{list-style-type:none}.search-form li.selected{background-color:#eee}.main-content{margin-left:300px}.player{display:flex;flex-direction:row}.player .player-avatar{width:170px;height:170px}.player .player-info{flex-grow:1;padding-left:20px}.match{margin:10px 0;padding:5px 0}.match .match-header{display:flex;flex-direction:row}.match .match-header .result{width:100px}.match .match-header .match-name{flex-grow:1;padding-left:20px}.match .match-header .timestamp{width:150px;padding:0 20px}.match .match-header .toggle{width:16px;padding:0 20px}.match .match-details .teams{display:flex;flex-direction:row}.match .match-details .teams .team{flex-grow:1;display:flex;flex-direction:row}.match .match-details .teams .team .avatar{width:240px;height:240px}.match .match-details .teams .team .players{flex-grow:1;padding-left:20px}.match{border:1px solid #eee;background:white;box-shadow:0px 8px 16px 0px rgba(0,0,0,0.2)}.match .match-header .result{text-align:center}.match .match-header .result .win{color:green}.match .match-header .result .loss{color:red}.match .match-header .match-name{border-left:1px solid lightgray;border-right:1px solid lightgray}.match .match-header .match-name .home-team{text-decoration:underline}.match .match-header .timestamp{text-align:center}.match .match-header .toggle{text-align:center;border-left:1px solid lightgray}.match .match-details{padding:20px;border-top:1px solid lightgray}\n",""]),e.exports=t}},[[81,1,2]]]);
//# sourceMappingURL=0.bundle.c394eaa97b28cb6db46d.js.map